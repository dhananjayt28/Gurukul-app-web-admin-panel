/*
 * Title - Common JS for entire project
 * Description - this js using for all common method for global.
 * Author - Jayanta Rakshit
 * Year - (c) 2018
 * Licence - nil
 */
!function ($) {
    "use strict";
    var BASEURL = window.location.origin + "/";
    var API_BASE_URL = "";
    //if (window.location.hostname.toLowerCase() === "localhost") {
    //   // API_BASE_URL = "http://testivpwebapi.ttssupport.info/";
    //   //API_BASE_URL = "http://ivdplive.ttssupport.info/";
    //} else {///ivdplive.ttssupport.info/api/get-master-organisation
    //   // API_BASE_URL = "http://ivdplive.ttssupport.info/";
    //  // API_BASE_URL = "http://testivpwebapi.ttssupport.info/";
    //}

    var isNUllorEmpty = function (val) {
        var _s = false;
        //return (val.trim() > 0 || val.trim() != null || val.trim() != "" || val.trim() != "null") ? true : false;
        switch (val) {
            case "0": { _s = true; } break;
            case "": { _s = true; } break;
            case 0: { _s = true; } break;
            case undefined: { _s = true; } break;
            case "undefined": { _s = true; } break;
            case null: { _s = true; } break;
            case "null": { _s = true; } break;
            case "NaN": { _s = true; } break;
            case NaN: { _s = true; } break;
        }
        return _s;
    };

    /***************************************
     * Title - Collect Project Base URL 
     * Parameter - SUB URL (Optional)
     * Return - Base URL
     * Syntax - $.baseurl();
     ***************************************/
    $.baseurl = function (url) {        
        BASEURL = typeof url === 'undefined' ? BASEURL : BASEURL + url;
        
        if ($.validregex(BASEURL, "url")) {
            return BASEURL;
        } else {
            throw "Invalid URL !!!";
        }
    }

    /***************************************
     * Title - Collect Project API Base URL 
     * Parameter - SUB URL (Optional)
     * Return - API Base URL
     * Syntax - $.apiurl();
     ***************************************/
    $.apiurl = function (url) {        
        API_BASE_URL = typeof url === 'undefined' ? API_BASE_URL : API_BASE_URL + url;

        if ($.validregex(API_BASE_URL, "url")) {
            return API_BASE_URL;
        } else {
            throw "Invalid URL !!!";
        }
    }

    $.isNull = function (value) {
        return isNUllorEmpty(value);
    }

    /***************************************
     * Title - Redirect one url to another url 
     * Parameter - URL
     * Return - null
     * Syntax - $.redirect();
     ***************************************/
    $.redirect = function (url) {
        url = typeof url === 'undefined' ? "" : url;
        if ($.validregex(url, "url")) {
            window.location.href = url;
        } else {
            throw "Invalid URL !!!"
        }        
    }

    $.validregex = function (val, type) {
        var isvalid = false;
        var regex;
        switch (type.toLowerCase()) {
            case "url": {
                regex = new RegExp("^(http|https)?:\/\/[a-zA-Z0-9-\.]+\.[a-z]{2,4}", "g");
                isvalid = regex.test(val);
            } break;
            case "mobile": {
                regex = new RegExp("^[0-9-+]{10}$");
                isvalid = regex.test(val);
            } break;
            case "email": {
                regex = new RegExp("^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$", "ig");
                isvalid = regex.test(val);
            } break;
            case "alpha": {
                regex = new RegExp("^[a-zA-Z]+$", "ig");
                isvalid = regex.test(val);
            } break;
            case "alphanumeric": {
                regex = new RegExp("[^a-zA-Z0-9 ]", "ig");
                isvalid = regex.test(val);
            } break;
        }
        return isvalid;
    }

    $.parseBool = function (str) {
        return /^true$/i.test(str);
    }

    $.formdata = function (formid) {
        var $form = new FormData($(formid)[0]);
        return $form;
    }
    $.fn.reset = function () {
        $(this).trigger("reset");
    }
    /***************************************
     * Title - Collect Project Mapping Sys Id Value
     * Parameter - input/select Id (Optional)
     * Return - selected PM id
     * Syntax - $.urlsegment();
     ***************************************/
    $.urlsegment = function (index) {
        var QueryParameter = window.location.pathname.split("/");
        var indexName = "";
        if (!isNUllorEmpty(parseInt(index)) && !isNaN(parseInt(index))) {
            if (QueryParameter.length >= index) {
                indexName = QueryParameter[index];
            } else {
                throw 'URL index out of range';
            }
        } else {
            throw 'URL index value is invalid.';
        }
        return indexName;
    }
    /***************************************
     * Title - Collect Controller name from URL
     * Parameter - null
     * Return - URL First Parameter according to Index
     * Syntax - $.getcontrollername();
     ***************************************/
    $.getcontrollername = function () {
        var QueryParameter = window.location.pathname.split("/");
        var indexName = "";
        if (QueryParameter.length >= 1) {
            indexName = QueryParameter[1];
        } else {
            throw 'Controller name is missing';
        }
        return indexName;
    }
    /***************************************
     * Title - Collect Action name from URL
     * Parameter - null
     * Return - URL Second Parameter according to Index
     * Syntax - $.getactionname();
     ***************************************/
    $.getactionname = function () {
        var QueryParameter = window.location.pathname.split("/");
        var indexName = "";
        if (QueryParameter.length >= 2) {
            indexName = QueryParameter[2];
        } else {
            throw 'Action name is missing';
        }
        return indexName;
    }

    /***************************************
     * Title - Collect Project Mapping Sys Id Value
     * Parameter - input/select Id (Optional)
     * Return - selected PM id
     * Syntax - $.GetPmId("projectmapid");
     ***************************************/
    $.getpmid = function (e) {
        var idName;
        var pmId = 0;
        idName = (e != null) ? e : "csrpmid";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                pmId = $this.val();
            }           
        }
        return pmId;
    };

    /***************************************
     * Title - Collect FY Id Value
     * Parameter - input/select Id (Optional)
     * Return - selected finacial id
     * Syntax - $.GetFyId("fy_list");
     ***************************************/
    $.getfyid = function (e) {
        var idName;
        var fyid = 0;
        idName = (e != null) ? e : "fy_list";
        var $this = $("#" + idName);
        if ($this.length > 0) {            
            if ($this.val() > 0) {
                fyid = $this.val();
            }            
        }
        return fyid;
    };

    /***************************************
     * Title - Collect Location Value
     * Parameter - input/select Id (Optional)
     * Return - selected Location id
     * Syntax - $.GetLocationId("Location_list");
     ***************************************/
    $.getlocationid = function (e) {
        var idName;
        var location_id = 0;
        idName = (e != null) ? e : "Location_list";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                location_id = $this.val();
            }            
        }
        return location_id;
    };

    /***************************************
     * Title - Collect Partner Value
     * Parameter - input/select Id (Optional)
     * Return - selected Partner id
     * Syntax - $.GetPartnerId("Partner_list");
     ***************************************/
    $.getpartnerid = function (e) {
        var idName, alterid;
        var partner_id = 0;
        idName = (e != null) ? e : "Partner_list";
        var $this = $("#" + idName);
        if ($this.length > 0) {            
            if ($this.val() > 0) {
                partner_id = $this.val();
            }
        } else {
            var $this = $("#orgid");
            if ($this.val() > 0) {
                partner_id = $this.val();
            }
        }
        return partner_id;
    };

    /***************************************
     * Title - Collect Program Value
     * Parameter - input/select Id (Optional)
     * Return - selected Program id
     * Syntax - $.GetPartnerId("Program_list");
     ***************************************/
    $.getprogramid = function (e) {
        var idName;
        var program_id = 0;
        idName = (e != null) ? e : "Program_list";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                program_id = $this.val();
            }            
        }
        return program_id;
    };

    /***************************************
     * Title - Collect Project Value
     * Parameter - input/select Id (Optional)
     * Return - selected Project id
     * Syntax - $.GetProjectId("Project_list");
     ***************************************/
    $.getprojectid = function (e) {
        var idName;
        var project_id = 0;
        idName = (e != null) ? e : "Project_list";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                project_id = $this.val();
            }            
        }
        return project_id;
    };

    /***************************************
     * Title - Collect User Value
     * Parameter - input/select Id (Optional)
     * Return - selected User id
     * Syntax - $.GetUserId("csruserid");
     ***************************************/
    $.getuserid = function (e) {
        var idName;
        var userId = 0;
        idName = (e != null) ? e : "csruserid";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                userId = $this.val();
            }            
        }
        return userId;
    };

    /***************************************
     * Title - Collect Role Value
     * Parameter - input/select Id (Optional)
     * Return - selected Role id
     * Syntax - $.GetRoleId("csrroleid");
     ***************************************/
    $.getroleid = function (e) {
        var idName;
        var role_id = 0;
        idName = (e != null) ? e : "csrroleid";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                role_id = $this.val();
            }            
        }
        return role_id;
    };

    /***************************************
     * Title - Collect Profile Value
     * Parameter - input/select Id (Optional)
     * Return - selected Profile id
     * Syntax - $.GetProfileId("csrproid");
     ***************************************/
    $.getprofileid = function (e) {
        var idName;
        var profile_id = 0;
        idName = (e != null) ? e : "csrproid";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                profile_id = $this.val();
            }            
        }
        return profile_id;
    };

    /***************************************
     * Title - Collect User Type Id
     * Parameter - input/select Id (Optional)
     * Return - selected User Type id
     * Syntax - $.getusertype("csrtypeid");
     ***************************************/
    $.getusertype = function (e) {
        var idName;
        var usertype = 0;
        idName = (e != null) ? e : "csrtypeid";
        var $this = $("#" + idName);
        if ($this.length > 0) {
            if ($this.val() > 0) {
                usertype = $this.val();
            }            
        }
        return usertype;
    };

    /***************************************
     * Title - Role Management 
     * Parameter - Role Id (Optional)
     * Return - selected User Type id
     * Syntax - $.rolemanagement(2);
     ***************************************/
    $.rolemanagement = function (e, data) {
        e = isNUllorEmpty(e) ? e : $.getroleid();
        var _anchorURL = "";
        var _pmId = $.getpmid();
        var _orgId = $.getpartnerid();
        var delBtnValidation = [8,4,3];
        /* Collect and Serialize, each data variable for easy to use */
        /* ---- Status ---- */
        var planning_status = data.PLANNING_STATUS;
        var outcome_status = data.OUTCOME_STATUS;
        var deliverable_status = data.DELIVERABLE_STATUS;
        var payment_status = data.PAYMENT_STATUS;
        /* ---- Message ---- */
        var planning_status_msg = data.PLANNING_STATUS_MSG;
        var outcome_status_msg = data.OUTCOME_STATUS_MSG;
        var deliverable_status_msg = data.DELIVERABLE_STATUS_MSG;
        var payment_status_msg = data.PAYMENT_STATUS_MSG;
        /* ---- Count ---- */
        var planning_count = data.PLANNING_COUNT;
        var outcome_count = data.OUTCOME_COUNT;
        var deliverable_count = data.DELIVERABLE_COUNT;
        var payment_count = data.PAYMENT_COUNT;
        /* End initialize */
        $("#addMonthlyPlanReportBtn").hide();
        $("#btn_planning_submit").hide();
        $("#btn_planning_approve").hide();
        $("#btn_planning_reject").hide();
        $("#btn_planning_verify").hide();
        $("#btn_planning_change").hide();
        if ($("#btn_planning_submit").length) { $("#btn_planning_pdf").hide(); }
        $("#text_comments_planning").hide();
        $("#div_planning").hide().children("label").hide();

        $("#OutcomeModalOpenBtn").hide();
        $("#btn_outcome_submit").hide();
        $("#btn_outcome_approve").hide();
        $("#btn_outcome_reject").hide();
        $("#btn_outcome_verify").hide();
        $("#btn_outcome_change").hide();
        if ($("#btn_outcome_pdf").length) { $("#btn_outcome_pdf").hide(); }
        $("#text_comments_outcome").hide();
        $("#div_outcome").hide().children("label").hide();

        $("#addNewDeliverableBtn").hide();
        $("#btn_deliverable_submit").hide();
        $("#btn_deliverable_approve").hide();
        $("#btn_deliverable_reject").hide();
        $("#btn_deliverable_verify").hide();
        $("#btn_deliverable_change").hide();
        if ($("#btn_deliverable_pdf").length) { $("#btn_deliverable_pdf").hide(); }
        $("#text_comments_deliverable").hide();
        $("#div_deliverable").hide().children("label").hide();


        $("#add_payment_schedule").hide();
        $("#btn_payment_schedule_submit").hide();
        $("#btn_payment_schedule_approve").hide();
        $("#btn_payment_schedule_verify").hide();
        $("#btn_payment_schedule_change").hide();
        $("#btn_payment_schedule_approve").hide();
        $("#btn_payment_schedule_reject").hide();
        if ($("#btn_payment_schedule_pdf").length) { $("#btn_payment_schedule_pdf").hide(); }
        $("#text_comments_payment_schedule").hide();
        $("#div_payment_schedule").hide().children("label").hide();
        
        

        switch (parseInt(e)) {
            case 3: {
                /*Maker*/
                /* 9 open */
                $("#addMonthlyPlanReportBtn").show();
                $("#OutcomeModalOpenBtn").show();
                $("#addNewDeliverableBtn").show();
                $("#add_payment_schedule").show();
                if (parseInt(planning_count) > 0) {
                    if (parseInt(planning_status) === 9 || parseInt(planning_status) === 20 || parseInt(planning_status) === 2) {                        
                        $("#text_comments_planning").show();
                        $("#btn_planning_submit").show();
                        $(".OutrechMouPlanDel").show();
                        $("#div_planning").show().children("label").show();
                    } else if (parseInt(planning_status) === 3) {
                        var _aTag = $("#btn_planning_pdf");
                        _anchorURL = BASEURL + "/projectmapping/outreach-pdf-download/" + _pmId;
                        _aTag.attr("href", _anchorURL);
                        _aTag.addClass("btn bg-red waves-effect");
                        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                        _aTag.show();
                        $("#div_planning").show().children("label").hide();
                    }
                }

                if (parseInt(outcome_count) > 0) {
                    if (parseInt(outcome_status) === 9 || parseInt(outcome_status) === 20 || parseInt(outcome_status) === 2) {
                        $("#text_comments_outcome").show();
                        $("#btn_outcome_submit").show();
                        $(".OutcomeMouPlanDel").show();
                        $("#div_outcome").show().children("label").show();
                    } else if (parseInt(outcome_status) === 3) {
                        var _aTag = $("#btn_outcome_pdf");
                        _anchorURL = BASEURL + "/projectmapping/outcome-pdf-download/" + _pmId;
                        _aTag.attr("href", _anchorURL);
                        _aTag.addClass("btn bg-red waves-effect");
                        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                        _aTag.show();
                        $("#div_outcome").show().children("label").hide();
                    }
                }

                if (parseInt(deliverable_count) > 0) {
                    if (parseInt(deliverable_status) === 9 || parseInt(deliverable_status) === 20 || parseInt(deliverable_status) === 2) {
                        $("#text_comments_deliverable").show();
                        $("#btn_deliverable_submit").show();
                        $(".DeliverableMouPlanDel").show();
                        $("#div_deliverable").show().children("label").show();
                    } else if (parseInt(deliverable_status) === 3) {
                        var _aTag = $("#btn_deliverable_pdf");
                        _anchorURL = BASEURL + "/projectmapping/deliverable-pdf-download/" + _pmId + "/" + _orgId;
                        _aTag.attr("href", _anchorURL);
                        _aTag.addClass("btn bg-red waves-effect");
                        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                        _aTag.show();
                        $("#div_deliverable").show().children("label").hide();
                    }
                }

                if (parseInt(payment_count) > 0) {
                    if (parseInt(payment_status) === 9 || parseInt(payment_status) === 20 || parseInt(payment_status) === 2) {
                        $("#text_comments_payment_schedule").show();
                        $("#btn_payment_schedule_submit").show();
                        $(".PaymentMouPlanDel").show();
                        $("#div_payment_schedule").show().children("label").show();
                    } else if (parseInt(payment_status) === 3) {
                        var _aTag = $("#btn_payment_schedule_pdf");
                        _anchorURL = BASEURL + "/projectmapping/paymentschedule-pdf-download/" + _pmId;
                        _aTag.attr("href", _anchorURL);
                        _aTag.addClass("btn bg-red waves-effect");
                        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                        _aTag.show();
                        $("#div_payment_schedule").show().children("label").hide();
                    }
                }
                
            } break;
            case 2: {
                /* Checker */
                /* 8 Insert */
                if (parseInt(planning_status) === 8) {
                    $("#text_comments_planning").show();
                    $("#btn_planning_verify").show();
                    $("#btn_planning_change").show();
                    $("#div_planning").show().children("label").show();
                } else if (parseInt(planning_status) === 3) {
                    var _aTag = $("#btn_planning_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outreach-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_planning").show().children("label").hide();
                }
                if (parseInt(outcome_status) === 8) {
                    $("#text_comments_outcome").show();
                    $("#btn_outcome_verify").show();
                    $("#btn_outcome_change").show();
                    $("#div_outcome").show().children("label").show();

                } else if (parseInt(outcome_status) === 3) {
                    var _aTag = $("#btn_outcome_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outcome-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_outcome").show().children("label").hide();
                }
                if (parseInt(deliverable_status) === 8) {
                    $("#text_comments_deliverable").show();
                    $("#btn_deliverable_verify").show();
                    $("#btn_deliverable_change").show();
                    $("#div_deliverable").show().children("label").show();

                } else if (parseInt(deliverable_status) === 3) {
                    var _aTag = $("#btn_deliverable_pdf");
                    _anchorURL = BASEURL + "/projectmapping/deliverable-pdf-download/" + _pmId + "/" + _orgId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_deliverable").show().children("label").hide();
                }
                if (parseInt(payment_status) === 8) {
                    $("#text_comments_payment_schedule").show();
                    $("#btn_payment_schedule_verify").show();
                    $("#btn_payment_schedule_change").show();
                    $("#div_payment_schedule").show().children("label").show();
                } else if (parseInt(payment_status) === 3) {
                    var _aTag = $("#btn_payment_schedule_pdf");
                    _anchorURL = BASEURL + "/projectmapping/paymentschedule-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_payment_schedule").show().children("label").hide();
                }

            } break;
            case 1: {
                /*Approver*/
               
                /* 4 - Verified */
                if (parseInt(planning_status) === 4) {
                    $("#text_comments_planning").show();
                    $("#btn_planning_approve").show();
                    $("#btn_planning_reject").show();
                    $("#div_planning").show().children("label").show();
                } else if (parseInt(planning_status) === 3) {
                    var _aTag = $("#btn_planning_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outreach-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_planning").show().children("label").hide();
                }
                if (parseInt(outcome_status) === 4) {
                    $("#text_comments_outcome").show();
                    $("#btn_outcome_approve").show();
                    $("#btn_outcome_reject").show();
                    $("#div_outcome").show().children("label").show();
                } else if (parseInt(outcome_status) === 3) {
                    var _aTag = $("#btn_outcome_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outcome-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_outcome").show().children("label").hide();
                }
                if (parseInt(deliverable_status) === 4) {
                    $("#text_comments_deliverable").show();
                    $("#btn_deliverable_approve").show();
                    $("#btn_deliverable_reject").show();
                    $("#div_deliverable").show().children("label").show();
                } else if (parseInt(deliverable_status) === 3) {
                    var _aTag = $("#btn_deliverable_pdf");
                    _anchorURL = BASEURL + "/projectmapping/deliverable-pdf-download/" + _pmId + "/" + _orgId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_deliverable").show().children("label").hide();
                }
                if (parseInt(payment_status) === 4) {
                    $("#text_comments_payment_schedule").show();
                    $("#btn_payment_schedule_approve").show();
                    $("#btn_payment_schedule_reject").show();
                    $("#div_payment_schedule").show().children("label").show();
                } else if (parseInt(payment_status) === 3) {
                    var _aTag = $("#btn_payment_schedule_pdf");
                    _anchorURL = BASEURL + "/projectmapping/paymentschedule-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_payment_schedule").show().children("label").hide();
                }
            } break;
        }


        if ($.inArray(parseInt(planning_status), delBtnValidation) !== -1) { $(".OutrechMouPlanDel").hide(); $("#addMonthlyPlanReportBtn").hide(); }
        if ($.inArray(parseInt(outcome_status), delBtnValidation) !== -1) { $(".OutcomeMouPlanDel").hide(); $("#OutcomeModalOpenBtn").hide();}
        if ($.inArray(parseInt(deliverable_status), delBtnValidation) !== -1) { $(".DeliverableMouPlanDel").hide(); $("#addNewDeliverableBtn").hide(); }
        if ($.inArray(parseInt(payment_status), delBtnValidation) !== -1) {
            $(".PaymentMouPlanDel").hide();
            $("#add_payment_schedule").hide();
        }
        if (parseInt(payment_count) === 0) { $(".PaymentMouPlanDel").hide(); }

        /* Show status message */
        $("#planing_status").html(planning_status_msg); $("#div_planning").show();
        $("#outcome_status").html(outcome_status_msg); $("#div_outcome").show();
        $("#deliverable_status").html(deliverable_status_msg); $("#div_deliverable").show();
        $("#payment_status").html(payment_status_msg); $("#div_payment_schedule").show();

        if (parseInt(planning_status) === 3 &&
            parseInt(outcome_status) === 3 &&
            parseInt(deliverable_status) === 3 &&
            parseInt(payment_status) === 3) {
            $("#li_initiate").show();
        } else {
            $("#li_initiate").hide();
        }
    };

    /***************************************
     * Title - Outreach Table Bind
     * Parameter - Project Mapping Sys Id(Numeric)
     * Return - NULL
     * Syntax - $.OutreachTableBind(2);
     ***************************************/
    $.OutreachTableBind = function (pm_id) {
        mouListBind(pm_id);
    };

    /***************************************
     * Title - OutCome Table Bind
     * Parameter - 
     * Return - NULL
     * Syntax - $.OutcomeTableBind(2);
     ***************************************/
    $.OutcomeTableBind = function (pm_id) {
        OutcomeTabledataBind(pm_id);
    };

    /***************************************
     * Title - Payment Schedule Table Bind
     * Parameter - 
     * Return - NULL
     * Syntax - $.PaymentScheduleTableBind(2);
     ***************************************/
    $.PaymentScheduleTableBind = function (pm_id) {
        ScheduleTabledataBind(pm_id);
    };

    /***************************************
     * Title - Deliverable Table Bind
     * Parameter - Project Mapping Id and Organisation Id
     * Return - NULL
     * Syntax - $.DeliverableTableBind(2,29);
     ***************************************/
    $.DeliverableTableBind = function (pm_id, org_id) {
        DeliverableTableDataBind(pm_id, org_id);
    };
    
    /***************************************
     * Title - Approval Table Bind
     * Parameter - Project Mapping Id
     * Return - NULL
     * Syntax - $.ApprovalTableBind(2);
     ***************************************/
    $.ApprovalTableBind = function (e) {
        var $TableBody = $("#approvalListData");
        //api/get-mou-approvals-data/{PROJECT_MAPPING_SYS_ID}
        if (isNUllorEmpty(e)) {
            $.ajax({
                url: BASEURL + "/api/get-mou-approvals-data/" + e,
                type: "GET",
                dataType: "json",
                success: function (data) {
                    //console.log(data);
                    //return false;
                    if (data.status) {
                        $TableBody.html("");                        
                        $.each(data.response, function (index, item) {
                            /* table body bind */
                            var eachrow = "<tr>"
                                        + "<td align=center>" + item.ITEM + "</td>"
                                        + "<td align=center>" + item.MAKERNAME + "</td>"
                                        + "<td align=center>" + item.MAKERDATE + "</td>"
                                        + "<td align=center>" + item.CHECKERNAME + "</td>"
                                        + "<td align=center>" + item.CHECKERDATE + "</td>"
                                        + "<td align=center>" + item.APPROVERNAME + "</td>"
                                        + "<td align=center>" + item.APPROVERDATE + "</td>"
                                        + "<td align=center>" + item.STATUS + "</td>"
                                        + '<td align=center><a href="javascript:void(0);" class="showApproverComment" data-checker="' + item.CHECKER_COMMENTS + '" data-maker="' + item.MAKER_COMMENTS + '" data-approver="' + item.APPROVER_COMMENTS + '"><i class="material-icons col-blue-grey">comment</i></a></td>'
                                        + "</tr>";
                            $TableBody.append(eachrow);
                        });

                    }
                },
                error: function (errorResponse) {
                    alert(errorResponse.response);
                }
            });
        }
        
    }

    /***************************************
    * Title - Status Flag
    * Parameter - Project Mapping Id, Role Id
    * Return - NULL
    * Syntax - $.getmouannexurestatus(2,8);
    ***************************************/
    $.getmouannexurestatus = function (mapid, role_id) {
        $.ajax({
            url: BASEURL + "/api/get-annexure-status-view/" + mapid,
            type: "GET",
            dataType: "json",
            success: function (data) {
                //return false;
                if (data.status) {                    
                    $.rolemanagement(role_id, data.response[0]);
                }
            }
        });
    }

    /***************************************
    * Title - Status Flag
    * Parameter - Project Mapping Id, Role Id
    * Return - NULL
    * Syntax - $.getmouannexurestatus(2,8);
    ***************************************/
    $.getpmstatus = function (mapid, role_id) {
        $.ajax({
            //url: BASEURL + "/api/get-projects-status-view/" + mapid,
            url: BASEURL + "/data.json",
            type: "GET",
            async:false,
            dataType: "json",
            success: function (data) {
                if (data.status) {
                    $.pmRoleManagement(role_id, data.response[0]);
                }
            }
        });
    }

    $.isMouPaymentInitiate = function (project_mapping_id) {
        $.ajax({
            url: BASEURL + "/api/initiate-mou-payments-status-check/" + project_mapping_id,
            type: "GET",
            async: false,
            dataType: "json",
            success: function (data) {
                if (data.status) {                
                    $("#btn_Initiate_Payment").hide();
                    $("#lbl_initiate_status").text(data.response.toString()).show();
                    return true;
                }
                else {
                    $("#btn_Initiate_Payment").show();
                    $("#lbl_initiate_status").text("").hide();
                    return false;
                }
            },
            error: function (errorResponse) {
                return false;
            }
        });
    };

    $.pmRoleManagement = function (e, data) {
        e = isNUllorEmpty(e) ? e : $.getroleid();
        var _anchorURL = "";
        var _pmId = $.getpmid();
        var _orgId = $.getpartnerid();
        var delBtnValidation = [8, 4, 3];
        //console.log(data);
        //return false;
        /* Collect and Serialize, each data variable for easy to use */
        /* ---- Status ---- */
        var reporting_status = data.REPORTING_STATUS;
        var outcome_status = data.OUTCOME_STATUS;
        var deliverable_status = data.DELIVERABLE_STATUS;
        var payment_status = data.PAYMENT_STATUS;
        /* ---- Message ---- */
        var reporting_status_msg = data.REPORTING_STATUS_MSG;
        var outcome_status_msg = data.OUTCOME_STATUS_MSG;
        var deliverable_status_msg = data.DELIVERABLE_STATUS_MSG;
        var payment_status_msg = data.PAYMENT_STATUS_MSG;
        /* ---- Count ---- */
        var reporting_count = data.REPORTING_COUNT;
        var outcome_count = data.OUTCOME_COUNT;
        var deliverable_count = data.DELIVERABLE_COUNT;
        var payment_count = data.PAYMENT_COUNT;
        /* End initialize */

        $("#btn_reporting_submit").hide();
        $("#btn_reporting_approve").hide();
        $("#btn_reporting_reject").hide();
        $("#btn_reporting_verify").hide();
        $("#btn_reporting_change").hide();
        if ($("#btn_reporting_pdf").length) { $("#btn_reporting_pdf").hide(); }
        $("#text_comments_reporting").hide();
        $("#div_reporting").hide().children("label").hide();

        //$("#btn_outcome_submit").hide();
        //$("#btn_outcome_approve").hide();
        //$("#`btn_outcome_reject").hide();
        //$("#btn_outcome_verify").hide();
        //$("#btn_outcome_change").hide();
        //if ($("#btn_outcome_pdf").length) { $("#btn_outcome_pdf").hide(); }
        //$("#text_comments_outcome").hide();
        //$("#div_outcome").hide().children("label").hide();

        $("#btn_actual_deliverable_submit").hide();
        $("#btn_actual_deliverable_approve").hide();
        $("#btn_actual_deliverable_reject").hide();
        $("#btn_actual_deliverable_verify").hide();
        $("#btn_actual_deliverable_change").hide();
        if ($("#btn_actual_deliverable_pdf").length) { $("#btn_actual_deliverable_pdf").hide(); }
        $("#text_comments_actual_deliverable").hide();
        $("#div_actual_deliverable").hide().children("label").hide();


        //$("#add_payment_schedule").hide();
        //$("#btn_payment_schedule_submit").hide();
        //$("#btn_payment_schedule_approve").hide();
        //$("#btn_payment_schedule_verify").hide();
        //$("#btn_payment_schedule_change").hide();
        //$("#btn_payment_schedule_approve").hide();
        //$("#btn_payment_schedule_reject").hide();
        //if ($("#btn_payment_schedule_pdf").length) { $("#btn_payment_schedule_pdf").hide(); }
        //$("#text_comments_payment_schedule").hide();
        //$("#div_payment_schedule").hide().children("label").hide();


        switch (parseInt(e)) {
            case 3: {
                /*Maker*/
                /* 9 open */
                if (parseInt(reporting_count) > 0) {
                    if (parseInt(reporting_status) === 9 || parseInt(reporting_status) === 20 || parseInt(reporting_status) === 2) {
                        $("#text_comments_reporting").show();
                        $("#btn_reporting_submit").show();
                        $("#div_reporting").show().children("label").show();
                    } else if (parseInt(reporting_status) === 3) {
                        var _aTag = $("#btn_reporting_pdf");
                        _anchorURL = BASEURL + "/projectmapping/outreach-pdf-download/" + _pmId;
                        _aTag.attr("href", _anchorURL);
                        _aTag.addClass("btn bg-red waves-effect");
                        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                        _aTag.show();
                        $("#div_planning").show().children("label").hide();
                    }
                }

                //if (parseInt(outcome_count) > 0) {
                //    if (parseInt(outcome_status) === 9 || parseInt(outcome_status) === 20 || parseInt(outcome_status) === 2) {
                //        $("#text_comments_outcome").show();
                //        $("#btn_outcome_submit").show();
                //        $(".OutcomeMouPlanDel").show();
                //        $("#div_outcome").show().children("label").show();
                //    } else if (parseInt(outcome_status) === 3) {
                //        var _aTag = $("#btn_outcome_pdf");
                //        _anchorURL = BASEURL + "/projectmapping/outcome-pdf-download/" + _pmId;
                //        _aTag.attr("href", _anchorURL);
                //        _aTag.addClass("btn bg-red waves-effect");
                //        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                //        _aTag.show();
                //        $("#div_outcome").show().children("label").hide();
                //    }
                //}

                if (parseInt(deliverable_count) > 0) {
                    if (parseInt(deliverable_status) === 9 || parseInt(deliverable_status) === 20 || parseInt(deliverable_status) === 2) {
                        $("#text_comments_actual_deliverable").show();
                        $("#btn_actual_deliverable_submit").show();
                        $("#div_actual_deliverable").show().children("label").show();
                    } else if (parseInt(deliverable_status) === 3) {
                        var _aTag = $("#btn_actual_deliverable_pdf");
                        _anchorURL = BASEURL + "/projectmapping/deliverable-pdf-download/" + _pmId + "/" + _orgId;
                        _aTag.attr("href", _anchorURL);
                        _aTag.addClass("btn bg-red waves-effect");
                        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                        _aTag.show();
                        $("#div_actual_deliverable").show().children("label").hide();
                    }
                }

                //if (parseInt(payment_count) > 0) {
                //    if (parseInt(payment_status) === 9 || parseInt(payment_status) === 20 || parseInt(payment_status) === 2) {
                //        $("#text_comments_payment_schedule").show();
                //        $("#btn_payment_schedule_submit").show();
                //        $(".PaymentMouPlanDel").show();
                //        $("#div_payment_schedule").show().children("label").show();
                //    } else if (parseInt(payment_status) === 3) {
                //        var _aTag = $("#btn_payment_schedule_pdf");
                //        _anchorURL = BASEURL + "/projectmapping/paymentschedule-pdf-download/" + _pmId;
                //        _aTag.attr("href", _anchorURL);
                //        _aTag.addClass("btn bg-red waves-effect");
                //        _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                //        _aTag.show();
                //        $("#div_payment_schedule").show().children("label").hide();
                //    }
                //}

            } break;
            case 2: {
                /* Checker */
                /* 8 Insert */
                if (parseInt(reporting_status) === 8) {
                    $("#text_comments_reporting").show();
                    $("#btn_planning_verify").show();
                    $("#btn_planning_change").show();
                    $("#div_planning").show().children("label").show();
                } else if (parseInt(reporting_status) === 3) {
                    var _aTag = $("#btn_reporting_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outreach-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_planning").show().children("label").hide();
                }
                if (parseInt(outcome_status) === 8) {
                    $("#text_comments_outcome").show();
                    $("#btn_outcome_verify").show();
                    $("#btn_outcome_change").show();
                    $("#div_outcome").show().children("label").show();

                } else if (parseInt(outcome_status) === 3) {
                    var _aTag = $("#btn_outcome_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outcome-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_outcome").show().children("label").hide();
                }
                if (parseInt(deliverable_status) === 8) {
                    $("#text_comments_deliverable").show();
                    $("#btn_deliverable_verify").show();
                    $("#btn_deliverable_change").show();
                    $("#div_actual_deliverable").show().children("label").show();

                } else if (parseInt(deliverable_status) === 3) {
                    var _aTag = $("#btn_actual_deliverable_pdf");
                    _anchorURL = BASEURL + "/projectmapping/deliverable-pdf-download/" + _pmId + "/" + _orgId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_actual_deliverable").show().children("label").hide();
                }
                if (parseInt(payment_status) === 8) {
                    $("#text_comments_payment_schedule").show();
                    $("#btn_payment_schedule_verify").show();
                    $("#btn_payment_schedule_change").show();
                    $("#div_payment_schedule").show().children("label").show();
                } else if (parseInt(payment_status) === 3) {
                    var _aTag = $("#btn_payment_schedule_pdf");
                    _anchorURL = BASEURL + "/projectmapping/paymentschedule-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_payment_schedule").show().children("label").hide();
                }

            } break;
            case 1: {
                /*Approver*/

                /* 4 - Verified */
                if (parseInt(reporting_status) === 4) {
                    $("#text_comments_reporting").show();
                    $("#btn_planning_approve").show();
                    $("#btn_planning_reject").show();
                    $("#div_planning").show().children("label").show();
                } else if (parseInt(reporting_status) === 3) {
                    var _aTag = $("#btn_reporting_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outreach-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_planning").show().children("label").hide();
                }
                if (parseInt(outcome_status) === 4) {
                    $("#text_comments_outcome").show();
                    $("#btn_outcome_approve").show();
                    $("#btn_outcome_reject").show();
                    $("#div_outcome").show().children("label").show();
                } else if (parseInt(outcome_status) === 3) {
                    var _aTag = $("#btn_outcome_pdf");
                    _anchorURL = BASEURL + "/projectmapping/outcome-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_outcome").show().children("label").hide();
                }
                if (parseInt(deliverable_status) === 4) {
                    $("#text_comments_deliverable").show();
                    $("#btn_actual_deliverable_approve").show();
                    $("#btn_actual_deliverable_reject").show();
                    $("#div_actual_deliverable").show().children("label").show();
                } else if (parseInt(deliverable_status) === 3) {
                    var _aTag = $("#btn_actual_deliverable_pdf");
                    _anchorURL = BASEURL + "/projectmapping/deliverable-pdf-download/" + _pmId + "/" + _orgId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_actual_deliverable").show().children("label").hide();
                }
                if (parseInt(payment_status) === 4) {
                    $("#text_comments_payment_schedule").show();
                    $("#btn_payment_schedule_approve").show();
                    $("#btn_payment_schedule_reject").show();
                    $("#div_payment_schedule").show().children("label").show();
                } else if (parseInt(payment_status) === 3) {
                    var _aTag = $("#btn_payment_schedule_pdf");
                    _anchorURL = BASEURL + "/projectmapping/paymentschedule-pdf-download/" + _pmId;
                    _aTag.attr("href", _anchorURL);
                    _aTag.addClass("btn bg-red waves-effect");
                    _aTag.html('<i class="material-icons">picture_as_pdf</i><span>Download as PDF</span>');
                    _aTag.show();
                    $("#div_payment_schedule").show().children("label").hide();
                }
            } break;
        }


        if ($.inArray(parseInt(reporting_status), delBtnValidation) !== -1) { $(".OutrechMouPlanDel").hide(); $("#addMonthlyPlanReportBtn").hide(); }
        if ($.inArray(parseInt(outcome_status), delBtnValidation) !== -1) { $(".OutcomeMouPlanDel").hide(); $("#OutcomeModalOpenBtn").hide(); }
        if ($.inArray(parseInt(deliverable_status), delBtnValidation) !== -1) { $(".DeliverableMouPlanDel").hide(); $("#addNewDeliverableBtn").hide(); }
        if ($.inArray(parseInt(payment_status), delBtnValidation) !== -1) {
            $(".PaymentMouPlanDel").hide();
            $("#add_payment_schedule").hide();
        }
        if (parseInt(payment_count) === 0) { $(".PaymentMouPlanDel").hide(); }

        /* Show status message */
        $("#planing_status").html(reporting_status_msg); $("#div_planning").show();
        $("#outcome_status").html(outcome_status_msg); $("#div_outcome").show();
        $("#actual_deliverable_status").html(deliverable_status_msg); $("#div_actual_deliverable").show();
        $("#payment_status").html(payment_status_msg); $("#div_payment_schedule").show();

        if (parseInt(reporting_status) === 3 &&
            parseInt(outcome_status) === 3 &&
            parseInt(deliverable_status) === 3 &&
            parseInt(payment_status) === 3) {
            $("#li_initiate").show();
        } else {
            $("#li_initiate").hide();
        }
    };

}(jQuery)